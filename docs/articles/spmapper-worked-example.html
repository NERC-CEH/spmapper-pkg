<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Worked example • spmapper</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Worked example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spmapper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/spmapper_methods.html">Methods</a></li>
    <li><a class="dropdown-item" href="../articles/spmapper_caveats_limitation.html">Uses, Caveats &amp; Limitations</a></li>
    <li><a class="dropdown-item" href="../articles/spmapper-worked-example.html">Worked example</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NERC-CEH/spmapper-pkg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Worked example</h1>
            
            <h4 data-toc-skip class="date">2025-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/NERC-CEH/spmapper-pkg/blob/HEAD/vignettes/spmapper-worked-example.Rmd" class="external-link"><code>vignettes/spmapper-worked-example.Rmd</code></a></small>
      <div class="d-none name"><code>spmapper-worked-example.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="load-packages-and-functions">Load packages and functions<a class="anchor" aria-label="anchor" href="#load-packages-and-functions"></a>
</h2>
<pre><code><span><span class="co">## terra 1.8.54</span></span></code></pre>
<pre><code><span><span class="co">## Linking to GEOS 3.13.1, GDAL 3.11.0, PROJ 9.6.0; sf_use_s2() is TRUE</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'knitr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:terra':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     spin</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: viridisLite</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'patchwork'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:terra':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     area</span></span></code></pre>
<pre><code><span><span class="co">## [1] ""</span></span></code></pre>
<pre><code><span><span class="co">## [1] ""</span></span></code></pre>
<pre><code><span><span class="co">## [1] ""</span></span></code></pre>
<pre><code><span><span class="co">## [1] ""</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="worked-example---nng-and-berwick-bank">Worked example - NnG and Berwick Bank<a class="anchor" aria-label="anchor" href="#worked-example---nng-and-berwick-bank"></a>
</h2>
<div class="section level3">
<h3 id="user-specified-polygons-to-use-in-example">User specified polygon(s) to use in example<a class="anchor" aria-label="anchor" href="#user-specified-polygons-to-use-in-example"></a>
</h3>
<p>NOTE: TEMPORARY</p>
<pre><code><span><span class="co">## Reading layer `windfarmspolyPolygon' from data source </span></span>
<span><span class="co">##   `C:\Users\clacap\AppData\Local\Temp\RtmpSKcpkE\temp_libpath5fd43c63f29\spmapper\demo\UK_OWF_polygons_by_status' </span></span>
<span><span class="co">##   using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 405 features and 9 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -10.14933 ymin: 45.70603 xmax: 15.16667 ymax: 60.70146</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span></code></pre>
<pre><code><span><span class="co">## Spherical geometry (s2) switched off</span></span></code></pre>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<p><img src="spmapper-worked-example_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="run-primary-function-spmapper-to-produce-prey-consumption-maps-for-each-species-and-optionally-extract-within-user-specified-polygons">Run primary function spmapper() to produce prey consumption maps for
each species and optionally extract within user specified polygons<a class="anchor" aria-label="anchor" href="#run-primary-function-spmapper-to-produce-prey-consumption-maps-for-each-species-and-optionally-extract-within-user-specified-polygons"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_kitt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Kittiwake"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## |---------|---------|---------|---------|=========================================                                          </span></span></code></pre>
<pre><code><span><span class="co">## Warning in fpudoverlap(fppolys = fppolys, udmap = udmap): Part or all of</span></span>
<span><span class="co">## footprint lies on land or outside area with UD values!</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_cogu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Guillemot"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## |---------|---------|---------|---------|=========================================                                          </span></span></code></pre>
<pre><code><span><span class="co">## Warning in fpudoverlap(fppolys = fppolys, udmap = udmap): Part or all of</span></span>
<span><span class="co">## footprint lies on land or outside area with UD values!</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_razo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Razorbill"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## |---------|---------|---------|---------|=========================================                                          </span></span></code></pre>
<pre><code><span><span class="co">## Warning in fpudoverlap(fppolys = fppolys, udmap = udmap): Part or all of</span></span>
<span><span class="co">## footprint lies on land or outside area with UD values!</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualise-prey-consumption-maps-with-optional-input-polygons-overlaid-using-spmapplot">Visualise prey consumption maps with optional input polygons
overlaid, using spmapplot()<a class="anchor" aria-label="anchor" href="#visualise-prey-consumption-maps-with-optional-input-polygons-overlaid-using-spmapplot"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot a single species map </span></span>
<span><span class="co"># spmapplot(out_razo$prey_cons_map, fppolys) + ggtitle("Razorbill")</span></span>
<span></span>
<span><span class="co"># Plot all species map # REMOVE and simply show how to plot one as above?? &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></span>
<span><span class="op">(</span><span class="fu"><a href="../reference/spmapplot.html">spmapplot</a></span><span class="op">(</span><span class="va">out_kitt</span><span class="op">$</span><span class="va">prey_cons_map</span>, <span class="va">fppolys</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Kittiwake"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="op">(</span><span class="fu"><a href="../reference/spmapplot.html">spmapplot</a></span><span class="op">(</span><span class="va">out_cogu</span><span class="op">$</span><span class="va">prey_cons_map</span>, <span class="va">fppolys</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Guillemot"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="op">(</span><span class="fu"><a href="../reference/spmapplot.html">spmapplot</a></span><span class="op">(</span><span class="va">out_razo</span><span class="op">$</span><span class="va">prey_cons_map</span>, <span class="va">fppolys</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Razorbill"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span>
<span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span>
<span><span class="co">## Coordinate system already present. Adding new coordinate system, which will</span></span>
<span><span class="co">## replace the existing one.</span></span></code></pre>
<p><img src="spmapper-worked-example_files/figure-html/unnamed-chunk-4-1.png" width="3200"></p>
</div>
<div class="section level3">
<h3 id="visualise-prey-mass-estimates">Visualise prey mass estimates<a class="anchor" aria-label="anchor" href="#visualise-prey-mass-estimates"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out_kitt</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, breaks<span class="op">=</span><span class="fl">50</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Kittiwake"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_kitt</span><span class="op">$</span><span class="va">allbirds_prey_est</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10000</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out_cogu</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, breaks<span class="op">=</span><span class="fl">50</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Guillemot"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_cogu</span><span class="op">$</span><span class="va">allbirds_prey_est</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10000</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">out_razo</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, breaks<span class="op">=</span><span class="fl">50</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Razorbill"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">out_razo</span><span class="op">$</span><span class="va">allbirds_prey_est</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10000</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="spmapper-worked-example_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_kitt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Species <span class="op">=</span> <span class="st">"Kittiwake"</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="va">out_kitt</span><span class="op">$</span><span class="va">allbirds_prey_est</span>, </span>
<span>  Sim_CI_Lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">out_kitt</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>, </span>
<span><span class="co"># Sim_Mean = mean(out_kitt$allbirds_prey_sim), </span></span>
<span>  Sim_CI_Upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">out_kitt</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab_cogu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Species <span class="op">=</span> <span class="st">"Guillemot"</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="va">out_cogu</span><span class="op">$</span><span class="va">allbirds_prey_est</span>, </span>
<span>  Sim_CI_Lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">out_cogu</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>, </span>
<span><span class="co"># Sim_Mean = mean(out_cogu$allbirds_prey_sim), </span></span>
<span>  Sim_CI_Upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">out_cogu</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab_razo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Species <span class="op">=</span> <span class="st">"Razorbill"</span>,</span>
<span>  Estimate <span class="op">=</span> <span class="va">out_razo</span><span class="op">$</span><span class="va">allbirds_prey_est</span>, </span>
<span>  Sim_CI_Lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">out_razo</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, <span class="fl">0.025</span><span class="op">)</span><span class="op">)</span>, </span>
<span> <span class="co"># Sim_Mean = mean(out_razo$allbirds_prey_sim), </span></span>
<span>  Sim_CI_Upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">out_razo</span><span class="op">$</span><span class="va">allbirds_prey_sim</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">tab_kitt</span>, <span class="va">tab_cogu</span>, <span class="va">tab_razo</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Species</th>
<th align="right">Estimate</th>
<th align="right">Sim_CI_Lower</th>
<th align="right">Sim_CI_Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Kittiwake</td>
<td align="right">4819894.3</td>
<td align="right">4085681.9</td>
<td align="right">5718792</td>
</tr>
<tr class="even">
<td align="left">Guillemot</td>
<td align="right">5681001.3</td>
<td align="right">4775665.0</td>
<td align="right">9955648</td>
</tr>
<tr class="odd">
<td align="left">Razorbill</td>
<td align="right">718604.3</td>
<td align="right">553496.9</td>
<td align="right">1122483</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="testing-mis-specification-of-inputs">Testing mis-specification of inputs<a class="anchor" aria-label="anchor" href="#testing-mis-specification-of-inputs"></a>
</h2>
<div class="section level3">
<h3 id="incorrect-species-name">Incorrect species name<a class="anchor" aria-label="anchor" href="#incorrect-species-name"></a>
</h3>
<p>The tool explicitly checks whether the provided species names are
valid (including capitalisation)</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"kittiwake"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in spmapper(spname = "kittiwake", fppolys = fppolys, popscen = "baseline", : Invalid species name: must be 'Kittiwake', 'Guillemot' or 'Razorbill'!</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="incorrect-population-scenario">Incorrect population scenario<a class="anchor" aria-label="anchor" href="#incorrect-population-scenario"></a>
</h3>
<p>The tool explicitly checks whether the provided scenario names are
valid (including capitalisation)</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Kittiwake"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"medium"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in spmapper(spname = "Kittiwake", fppolys = fppolys, popscen = "medium", : Invalid population scenario: must be 'low', 'baseline' or 'high'</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="incorrect-path-to-tool">Incorrect path to tool<a class="anchor" aria-label="anchor" href="#incorrect-path-to-tool"></a>
</h3>
<p>The tool does not currently explicitly check if the path provided is
correct/valid, but may yield sensible error messages if an incorrect
path is specified</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Kittiwake"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="st">"test"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in file(file, "rt"): cannot open file 'test/fame_population_ests.csv':</span></span>
<span><span class="co">## No such file or directory</span></span></code></pre>
<pre><code><span><span class="co">## Error in file(file, "rt"): cannot open the connection</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="validity-of-footprints">Validity of footprints<a class="anchor" aria-label="anchor" href="#validity-of-footprints"></a>
</h3>
<p>The tool does not check directly for the validity of the polygons
provided</p>
</div>
<div class="section level3">
<h3 id="inconsistencies-between-footprint-polygons-and-uds">Inconsistencies between footprint polygons and UDs<a class="anchor" aria-label="anchor" href="#inconsistencies-between-footprint-polygons-and-uds"></a>
</h3>
<p>The tool runs three checks for consistency between polygons and the
UD map</p>
<div class="section level4">
<h4 id="footprints-smaller-than-one-grid-cell">Footprints smaller than one grid cell<a class="anchor" aria-label="anchor" href="#footprints-smaller-than-one-grid-cell"></a>
</h4>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fppolys</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"demo/North_Sea_OWF_2030_polygons"</span>, package <span class="op">=</span> <span class="st">"spmapper"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `North_Sea_OWF_2030_polygons' from data source </span></span>
<span><span class="co">##   `C:\Users\clacap\AppData\Local\Temp\RtmpSKcpkE\temp_libpath5fd43c63f29\spmapper\demo\North_Sea_OWF_2030_polygons' </span></span>
<span><span class="co">##   using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 177 features and 4 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -269946.2 ymin: -4249826 xmax: 697913.1 ymax: -3159479</span></span>
<span><span class="co">## Projected CRS: North_Pole_Lambert_Azimuthal_Equal_Area</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fppolys</span> <span class="op">&lt;-</span> <span class="va">fppolys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">fppolys</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Kittiwake"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in fpudoverlap(fppolys = fppolys, udmap = udmap): Size of footprint is smaller than the size of a single grid cell - tool would not produce meaningful results in this situation</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="footprints-outside-extent-of-ud">Footprints outside extent of UD<a class="anchor" aria-label="anchor" href="#footprints-outside-extent-of-ud"></a>
</h4>
<p>Note: the extent of the UD maps varies between species</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fppolys</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"demo/North_Sea_OWF_2030_polygons"</span>, package <span class="op">=</span> <span class="st">"spmapper"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `North_Sea_OWF_2030_polygons' from data source </span></span>
<span><span class="co">##   `C:\Users\clacap\AppData\Local\Temp\RtmpSKcpkE\temp_libpath5fd43c63f29\spmapper\demo\North_Sea_OWF_2030_polygons' </span></span>
<span><span class="co">##   using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 177 features and 4 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -269946.2 ymin: -4249826 xmax: 697913.1 ymax: -3159479</span></span>
<span><span class="co">## Projected CRS: North_Pole_Lambert_Azimuthal_Equal_Area</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fppolys</span> <span class="op">&lt;-</span> <span class="va">fppolys</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Guillemot"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in fpudoverlap(fppolys = fppolys, udmap = udmap): Polygon lies partly or completely outside area of selected grid!</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="footprints-on-land-or-in-other-areas-of-map-without-values">Footprints on land (or in other areas of map without values)<a class="anchor" aria-label="anchor" href="#footprints-on-land-or-in-other-areas-of-map-without-values"></a>
</h4>
<p>Note: this may be footprints on land, but it could also be footprints
in areas that are within extent but have missing values as weren’t
included in the original modelling in Wakefield et al. (2017)</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fppolys</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"demo/North_Sea_OWF_2030_polygons"</span>, package <span class="op">=</span> <span class="st">"spmapper"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `North_Sea_OWF_2030_polygons' from data source </span></span>
<span><span class="co">##   `C:\Users\clacap\AppData\Local\Temp\RtmpSKcpkE\temp_libpath5fd43c63f29\spmapper\demo\North_Sea_OWF_2030_polygons' </span></span>
<span><span class="co">##   using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 177 features and 4 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -269946.2 ymin: -4249826 xmax: 697913.1 ymax: -3159479</span></span>
<span><span class="co">## Projected CRS: North_Pole_Lambert_Azimuthal_Equal_Area</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fppolys</span> <span class="op">&lt;-</span> <span class="va">fppolys</span><span class="op">[</span><span class="fl">155</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spmapper.html">spmapper</a></span><span class="op">(</span>spname <span class="op">=</span> <span class="st">"Guillemot"</span>, fppolys <span class="op">=</span> <span class="va">fppolys</span>, popscen <span class="op">=</span> <span class="st">"baseline"</span>, tooldir <span class="op">=</span> <span class="va">tooldir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## |---------|---------|---------|---------|=========================================                                          </span></span></code></pre>
<pre><code><span><span class="co">## Warning in fpudoverlap(fppolys = fppolys, udmap = udmap): Part or all of</span></span>
<span><span class="co">## footprint lies on land or outside area with UD values!</span></span></code></pre>
<pre><code><span><span class="co">## Error in fpudoverlap(fppolys = fppolys, udmap = udmap): Zero overlap between footprint and any grid cell</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oliver Leedham.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
